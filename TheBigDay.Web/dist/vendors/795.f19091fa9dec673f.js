"use strict";(self.webpackChunkvendors=self.webpackChunkvendors||[]).push([[795],{9875:(_,h,n)=>{n.d(h,{q:()=>H});var u=n(2100),t=n(4438),x=n(9602),d=n(5779),a=n(5534),G=n(7172),f=n(4262),F=n(4464),T=n(111);let v=(()=>{class o extends F.G{constructor(e){super(e),this.productUrl=T.c.apiUrl+"product"}getProducts(){return this.get(this.productUrl)}addProduct(e){return this.post(this.productUrl+"/add",e)}updateProduct(e){return this.put(`${this.productUrl}/${e.id}`,e)}deleteProduct(e){return this.delete(`${this.productUrl}/${e}`)}static#t=this.\u0275fac=function(r){return new(r||o)(t.KVO(t.zZn))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var C=n(1796),m=n(177),P=n(1141),R=n(2242),y=n(8150),g=n(4341),I=n(1142),S=n(7480),b=n(9998),M=n(4799),j=n(8409);const N=()=>({height:"320px"});function l(o,c){if(1&o){const e=t.RV6();t.j41(0,"p-button",14),t.bIt("onClick",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.deleteConfirmation())}),t.k0s()}2&o&&t.Y8G("text",!0)}function V(o,c){if(1&o){const e=t.RV6();t.j41(0,"p-button",15),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.save())}),t.k0s()}}function X(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",1)(1,"label",2),t.EFF(2,"Name"),t.k0s(),t.j41(3,"input",3),t.mxI("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.DH7(s.product.name,i)||(s.product.name=i),t.Njj(i)}),t.k0s(),t.j41(4,"div",4)(5,"label",2),t.EFF(6,"Description"),t.k0s(),t.j41(7,"p-editor",5),t.mxI("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.DH7(s.product.description,i)||(s.product.description=i),t.Njj(i)}),t.k0s()(),t.j41(8,"div",6)(9,"div")(10,"label",2),t.EFF(11,"Min Guest Limit"),t.k0s(),t.j41(12,"p-inputNumber",7),t.mxI("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.DH7(s.product.minGuestLimit,i)||(s.product.minGuestLimit=i),t.Njj(i)}),t.k0s()(),t.j41(13,"div")(14,"label",2),t.EFF(15,"Max Guest List"),t.k0s(),t.j41(16,"p-inputNumber",7),t.mxI("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.DH7(s.product.maxGuestLimit,i)||(s.product.maxGuestLimit=i),t.Njj(i)}),t.k0s()()(),t.j41(17,"label",2),t.EFF(18,"Price"),t.k0s(),t.j41(19,"p-inputNumber",7),t.mxI("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.DH7(s.product.price,i)||(s.product.price=i),t.Njj(i)}),t.k0s(),t.j41(20,"div",4)(21,"label",2),t.EFF(22,"Price Type"),t.k0s(),t.j41(23,"p-dropdown",8),t.bIt("ngModelChange",function(i){t.eBV(e);const s=t.XpG();return t.Njj(s.onPriceTypeChanged(i))}),t.k0s()(),t.j41(24,"div",9),t.DNE(25,l,1,1,"p-button",10),t.j41(26,"p-button",11),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.close())}),t.k0s(),t.DNE(27,V,1,0,"p-button",12),t.nrm(28,"app-loading",13),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.R50("ngModel",e.product.name),t.R7$(4),t.Aen(t.lJ4(12,N)),t.R50("ngModel",e.product.description),t.R7$(5),t.R50("ngModel",e.product.minGuestLimit),t.R7$(4),t.R50("ngModel",e.product.maxGuestLimit),t.R7$(3),t.R50("ngModel",e.product.price),t.R7$(4),t.Y8G("options",e.priceTypeOptions)("ngModel",e.product.priceType),t.R7$(2),t.Y8G("ngIf",e.product.id),t.R7$(2),t.Y8G("ngIf",!e.loading),t.R7$(),t.Y8G("showLoading",e.loading)}}let p=(()=>{class o{constructor(e,r,i,s,z,J){this.dialogConfig=e,this.productService=r,this.ref=i,this.messageService=s,this.confirmationService=z,this.auth=J,this.product={description:"",id:void 0,isDeleted:!1,maxGuestLimit:0,minGuestLimit:0,name:"",storeId:"",packageProducts:void 0,eventProducts:void 0,price:0,priceType:G.S.FLAT},this.onClose=new t.bkB,this.loading=!1,this.priceTypeOptions=f.k,e&&e.data&&(this.product=e.data)}ngOnInit(){""===this.product.storeId&&this.auth.current&&this.auth.current.storeId&&(this.product.storeId=this.auth.current.storeId)}save(){this.loading=!0,this.product.id?this.productService.updateProduct(this.product).subscribe({next:()=>{this.confirmation("Product updated")},error:e=>{this.confirmation("Failed to update product",e.message)}}):this.productService.addProduct(this.product).subscribe({next:()=>{this.confirmation("Product added")},error:e=>{this.confirmation("Failed to add product",e.message)}})}confirmation(e,r){this.loading=!1,r?this.messageService.add((0,a.T)(a.P.ERROR,e+r)):this.close((0,a.T)(a.P.SUCCESS,e))}close(e){this.ref.close(e)}onPriceTypeChanged(e){this.product.priceType=e.key}delete(){this.loading=!0,this.productService.deleteProduct(this.product.id).subscribe({next:()=>{this.confirmation("product deleted")},error:e=>{this.confirmation("failed to delete product",e.message)}})}deleteConfirmation(){this.confirmationService.confirm({message:"Are you sure that you want to delete this product?",icon:"pi pi-exclamation-triangle",acceptIcon:"pi pi-times",rejectIcon:"none",acceptLabel:"Delete",rejectLabel:"Cancel",accept:()=>this.delete()})}static#t=this.\u0275fac=function(r){return new(r||o)(t.rXU(u.sb),t.rXU(v),t.rXU(u.Pw),t.rXU(d.bg),t.rXU(d.td),t.rXU(C.V))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-add-product-form"]],outputs:{onClose:"onClose"},features:[t.Jv_([x.Pe,d.bg,d.td])],decls:3,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],[1,"block","text-900","font-medium","mb-2"],["type","text","pInputText","",1,"w-full","mb-3",3,"ngModelChange","ngModel"],[1,"w-full","mb-3"],[3,"ngModelChange","ngModel"],[1,"lg:flex","gap-3"],["inputId","integeronly",1,"w-full","mb-3",3,"ngModelChange","ngModel"],["optionLabel","value",1,"w-full","mb-3",3,"ngModelChange","options","ngModel"],[1,"flex","justify-content-end","gap-3","mt-2"],["icon","pi pi-trash","severity","danger",3,"text","onClick",4,"ngIf"],["icon","pi pi-times","label","cancel",3,"click"],["icon","pi pi-check","label","Save","styleClass","p-button-success",3,"click",4,"ngIf"],[3,"showLoading"],["icon","pi pi-trash","severity","danger",3,"onClick","text"],["icon","pi pi-check","label","Save","styleClass","p-button-success",3,"click"]],template:function(r,i){1&r&&(t.DNE(0,X,29,13,"div",0),t.nrm(1,"p-toast")(2,"p-confirmDialog")),2&r&&t.Y8G("ngIf",i.product)},dependencies:[m.bT,P.$n,R.S,y.ms,g.me,g.BC,g.vS,I.KE,S.YI,b.y8,M.T,j.q]})}return o})();var D=n(577),E=n(9903);const U=()=>({"min-width":"50rem"});function $(o,c){if(1&o&&(t.j41(0,"th"),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.R7$(),t.SpI(" ",e.key," ")}}function A(o,c){if(1&o&&(t.j41(0,"tr"),t.DNE(1,$,2,1,"th",11),t.k0s()),2&o){const e=c.$implicit;t.R7$(),t.Y8G("ngForOf",e)}}function L(o,c){if(1&o&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&o){const e=c.$implicit,r=t.XpG().$implicit,i=t.XpG(3);t.R7$(),t.SpI(" ",e.key===i.ProductColumnNames.PRICE_TYPE?i.getPriceTypeCellData(r[e.value]):r[e.value]," ")}}function Y(o,c){if(1&o&&(t.j41(0,"tr",12),t.DNE(1,L,2,1,"td",11),t.k0s()),2&o){const r=c.columns;t.Y8G("pSelectableRow",c.$implicit),t.R7$(),t.Y8G("ngForOf",r)}}function B(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",7)(1,"p-table",8),t.bIt("onRowSelect",function(i){t.eBV(e);const s=t.XpG(2);return t.Njj(s.onRowSelect(i))}),t.DNE(2,A,2,1,"ng-template",9)(3,Y,2,2,"ng-template",10),t.k0s()()}if(2&o){const e=t.XpG(2);t.R7$(),t.Y8G("columns",e.productColumns)("value",e.products)("tableStyle",t.lJ4(3,U))}}function k(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"h5"),t.EFF(4,"Products"),t.k0s(),t.j41(5,"button",5),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.createProduct())}),t.k0s()(),t.DNE(6,B,4,4,"div",6),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(5),t.Y8G("disabled",!(null!=e.auth.current&&e.auth.current.hasCompletedProfile&&null!=e.auth.current&&null!=e.auth.current.store&&e.auth.current.store.hasCompletedStoreSetup&&null!=e.auth.current&&null!=e.auth.current.store&&e.auth.current.store.storeType)),t.R7$(),t.Y8G("ngIf",e.products&&e.products.length>0)}}function O(o,c){if(1&o&&(t.j41(0,"div",13),t.nrm(1,"app-loading",14),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("showLoading",e.loading)}}let H=(()=>{class o{constructor(e,r,i,s){this.productsService=e,this.dialogService=r,this.messageService=i,this.auth=s,this.loading=!0,this.ref=new u.Pw,this.ProductColumnNames=D.q,this.productColumns=D.E,this.getPriceTypeCellData=f.K}ngOnInit(){this.updateData()}createProduct(){this.ref=this.dialogService.open(p,{header:"New product",width:"50rem",maximizable:!0}),this.onCloseSubscribe()}onRowSelect(e){this.ref=this.dialogService.open(p,{header:"Edit: "+e.data.name,data:e.data,width:"50rem",maximizable:!0}),this.onCloseSubscribe()}onCloseSubscribe(){this.ref.onClose.subscribe(e=>{e&&(this.messageService.add(e),this.updateData())})}updateData(){this.loading=!0,this.productsService.getProducts().subscribe({next:e=>{this.loading=!1,this.products=e},error:e=>this.messageService.add((0,a.T)(a.P.ERROR,e.message))})}static#t=this.\u0275fac=function(r){return new(r||o)(t.rXU(v),t.rXU(u.o3),t.rXU(d.bg),t.rXU(C.V))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-products"]],features:[t.Jv_([u.o3,d.bg])],decls:3,vars:2,consts:[["class","grid",4,"ngIf"],["class","flex justify-content-center",4,"ngIf"],[1,"grid"],[1,"col-12"],[1,"flex","justify-content-between","align-items-center"],["pButton","","pRipple","","label","Add","icon","pi pi-plus",1,"mb-3",3,"click","disabled"],["class","card",4,"ngIf"],[1,"card"],["selectionMode","single","p-datatable-striped","",3,"onRowSelect","columns","value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[4,"ngFor","ngForOf"],[3,"pSelectableRow"],[1,"flex","justify-content-center"],[3,"showLoading"]],template:function(r,i){1&r&&(t.DNE(0,k,7,2,"div",0),t.nrm(1,"p-toast"),t.DNE(2,O,2,1,"div",1)),2&r&&(t.Y8G("ngIf",!i.loading),t.R7$(2),t.Y8G("ngIf",i.loading))},dependencies:[m.Sq,m.bT,P._f,d.Ei,E.XI,E.d5,b.y8,j.q]})}return o})()},795:(_,h,n)=>{n.r(h),n.d(h,{ProductsModule:()=>N});var u=n(177),t=n(6348),x=n(9875),d=n(4438);let a=(()=>{class l{static#t=this.\u0275fac=function(p){return new(p||l)};static#e=this.\u0275mod=d.$C({type:l});static#n=this.\u0275inj=d.G2t({imports:[t.iI.forChild([{path:"",component:x.q}]),t.iI]})}return l})();var G=n(1141),f=n(2242),F=n(9903),T=n(6296),v=n(8150),C=n(9266),m=n(1579),P=n(4341),R=n(1142),y=n(7480),g=n(1305),I=n(5430),S=n(1631),b=n(9998),M=n(4799),j=n(5193);let N=(()=>{class l{static#t=this.\u0275fac=function(p){return new(p||l)};static#e=this.\u0275mod=d.$C({type:l});static#n=this.\u0275inj=d.G2t({imports:[u.MD,a,G.tm,f.u,F.bG,T.iV,v.kr,C.SW,m.d,P.YN,R.sv,y.O3,g.f,I.q4,S.H_,b.MB,M.F,j.H]})}return l})()}}]);