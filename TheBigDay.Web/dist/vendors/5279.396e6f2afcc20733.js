"use strict";(self.webpackChunkvendors=self.webpackChunkvendors||[]).push([[5279],{5279:(nt,f,r)=>{r.r(f),r.d(f,{ProductsModule:()=>tt});var p=r(177),v=r(6348),l=r(2100),t=r(4438),I=r(9602),d=r(5779),a=r(5534),y=r(7172),C=r(4262),S=r(4464),M=r(111);let _=(()=>{class o extends S.G{constructor(e){super(e),this.productUrl=M.c.apiUrl+"product"}getProducts(){return this.get(this.productUrl)}addProduct(e){return this.post(this.productUrl+"/add",e)}updateProduct(e){return this.put(`${this.productUrl}/${e.id}`,e)}deleteProduct(e){return this.delete(`${this.productUrl}/${e}`)}static#t=this.\u0275fac=function(i){return new(i||o)(t.KVO(t.zZn))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var N=r(991),m=r(1141),b=r(2242),P=r(8150),u=r(4341),j=r(1142),x=r(7480),g=r(9998),G=r(4799),T=r(8409);const D=()=>({height:"320px"});function X(o,c){if(1&o){const e=t.RV6();t.j41(0,"p-button",14),t.bIt("onClick",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.deleteConfirmation())}),t.k0s()}2&o&&t.Y8G("text",!0)}function E(o,c){if(1&o){const e=t.RV6();t.j41(0,"p-button",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.save())}),t.k0s()}}function k(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",1)(1,"label",2),t.EFF(2,"Name"),t.k0s(),t.j41(3,"input",3),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.product.name,n)||(s.product.name=n),t.Njj(n)}),t.k0s(),t.j41(4,"div",4)(5,"label",2),t.EFF(6,"Description"),t.k0s(),t.j41(7,"p-editor",5),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.product.description,n)||(s.product.description=n),t.Njj(n)}),t.k0s()(),t.j41(8,"div",6)(9,"div")(10,"label",2),t.EFF(11,"Min Guest Limit"),t.k0s(),t.j41(12,"p-inputNumber",7),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.product.minGuestLimit,n)||(s.product.minGuestLimit=n),t.Njj(n)}),t.k0s()(),t.j41(13,"div")(14,"label",2),t.EFF(15,"Max Guest List"),t.k0s(),t.j41(16,"p-inputNumber",7),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.product.maxGuestLimit,n)||(s.product.maxGuestLimit=n),t.Njj(n)}),t.k0s()()(),t.j41(17,"label",2),t.EFF(18,"Price"),t.k0s(),t.j41(19,"p-inputNumber",7),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.product.price,n)||(s.product.price=n),t.Njj(n)}),t.k0s(),t.j41(20,"div",4)(21,"label",2),t.EFF(22,"Price Type"),t.k0s(),t.j41(23,"p-dropdown",8),t.bIt("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.onPriceTypeChanged(n))}),t.k0s()(),t.j41(24,"div",9),t.DNE(25,X,1,1,"p-button",10),t.j41(26,"p-button",11),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.close())}),t.k0s(),t.DNE(27,E,1,0,"p-button",12),t.nrm(28,"app-loading",13),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.R50("ngModel",e.product.name),t.R7$(4),t.Aen(t.lJ4(12,D)),t.R50("ngModel",e.product.description),t.R7$(5),t.R50("ngModel",e.product.minGuestLimit),t.R7$(4),t.R50("ngModel",e.product.maxGuestLimit),t.R7$(3),t.R50("ngModel",e.product.price),t.R7$(4),t.Y8G("options",e.priceTypeOptions)("ngModel",e.product.priceType),t.R7$(2),t.Y8G("ngIf",e.product.id),t.R7$(2),t.Y8G("ngIf",!e.loading),t.R7$(),t.Y8G("showLoading",e.loading)}}let F=(()=>{class o{constructor(e,i,n,s,et,ot){this.dialogConfig=e,this.productService=i,this.ref=n,this.messageService=s,this.confirmationService=et,this.auth=ot,this.product={description:"",id:void 0,isDeleted:!1,maxGuestLimit:0,minGuestLimit:0,name:"",storeId:"",packageProducts:void 0,eventProducts:void 0,price:0,priceType:y.S.FLAT},this.onClose=new t.bkB,this.loading=!1,this.priceTypeOptions=C.k,e&&e.data&&(this.product=e.data)}ngOnInit(){""===this.product.storeId&&this.auth.current&&this.auth.current.storeId&&(this.product.storeId=this.auth.current.storeId)}save(){this.loading=!0,this.product.id?this.productService.updateProduct(this.product).subscribe({next:()=>{this.confirmation("Product updated")},error:e=>{this.confirmation("Failed to update product",e.message)}}):this.productService.addProduct(this.product).subscribe({next:()=>{this.confirmation("Product added")},error:e=>{this.confirmation("Failed to add product",e.message)}})}confirmation(e,i){this.loading=!1,i?this.messageService.add((0,a.T)(a.P.ERROR,e+i)):this.close((0,a.T)(a.P.SUCCESS,e))}close(e){this.ref.close(e)}onPriceTypeChanged(e){this.product.priceType=e.key}delete(){this.loading=!0,this.productService.deleteProduct(this.product.id).subscribe({next:()=>{this.confirmation("product deleted")},error:e=>{this.confirmation("failed to delete product",e.message)}})}deleteConfirmation(){this.confirmationService.confirm({message:"Are you sure that you want to delete this product?",icon:"pi pi-exclamation-triangle",acceptIcon:"pi pi-times",rejectIcon:"none",acceptLabel:"Delete",rejectLabel:"Cancel",accept:()=>this.delete()})}static#t=this.\u0275fac=function(i){return new(i||o)(t.rXU(l.sb),t.rXU(_),t.rXU(l.Pw),t.rXU(d.bg),t.rXU(d.td),t.rXU(N.V))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-add-product-form"]],outputs:{onClose:"onClose"},features:[t.Jv_([I.Pe,d.bg,d.td])],decls:3,vars:1,consts:[["class","w-full",4,"ngIf"],[1,"w-full"],[1,"block","text-900","font-medium","mb-2"],["type","text","pInputText","",1,"w-full","mb-3",3,"ngModelChange","ngModel"],[1,"w-full","mb-3"],[3,"ngModelChange","ngModel"],[1,"lg:flex","gap-3"],["inputId","integeronly",1,"w-full","mb-3",3,"ngModelChange","ngModel"],["optionLabel","value",1,"w-full","mb-3",3,"ngModelChange","options","ngModel"],[1,"flex","justify-content-end","gap-3","mt-2"],["icon","pi pi-trash","severity","danger",3,"text","onClick",4,"ngIf"],["icon","pi pi-times","label","cancel",3,"click"],["icon","pi pi-check","label","Save","styleClass","p-button-success",3,"click",4,"ngIf"],[3,"showLoading"],["icon","pi pi-trash","severity","danger",3,"onClick","text"],["icon","pi pi-check","label","Save","styleClass","p-button-success",3,"click"]],template:function(i,n){1&i&&(t.DNE(0,k,29,13,"div",0),t.nrm(1,"p-toast")(2,"p-confirmDialog")),2&i&&t.Y8G("ngIf",n.product)},dependencies:[p.bT,m.$n,b.S,P.ms,u.me,u.BC,u.vS,j.KE,x.YI,g.y8,G.T,T.q]})}return o})();var R=r(577),h=r(9903);const V=()=>({"min-width":"50rem"});function A(o,c){if(1&o&&(t.j41(0,"th"),t.EFF(1),t.k0s()),2&o){const e=c.$implicit;t.R7$(),t.SpI(" ",e.key," ")}}function L(o,c){if(1&o&&(t.j41(0,"tr"),t.DNE(1,A,2,1,"th",10),t.k0s()),2&o){const e=c.$implicit;t.R7$(),t.Y8G("ngForOf",e)}}function U(o,c){if(1&o&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&o){const e=c.$implicit,i=t.XpG().$implicit,n=t.XpG(3);t.R7$(),t.SpI(" ",e.key===n.ProductColumnNames.PRICE_TYPE?n.getPriceTypeCellData(i[e.value]):i[e.value]," ")}}function $(o,c){if(1&o&&(t.j41(0,"tr",11),t.DNE(1,U,2,1,"td",10),t.k0s()),2&o){const i=c.columns;t.Y8G("pSelectableRow",c.$implicit),t.R7$(),t.Y8G("ngForOf",i)}}function B(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",6)(1,"p-table",7),t.bIt("onRowSelect",function(n){t.eBV(e);const s=t.XpG(2);return t.Njj(s.onRowSelect(n))}),t.DNE(2,L,2,1,"ng-template",8)(3,$,2,2,"ng-template",9),t.k0s()()}if(2&o){const e=t.XpG(2);t.R7$(),t.Y8G("columns",e.productColumns)("value",e.products)("tableStyle",t.lJ4(3,V))}}function Y(o,c){if(1&o){const e=t.RV6();t.j41(0,"div",2)(1,"div",3)(2,"button",4),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.createProduct())}),t.k0s(),t.DNE(3,B,4,4,"div",5),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.Y8G("ngIf",e.products&&e.products.length>0)}}function O(o,c){if(1&o&&(t.j41(0,"div",12),t.nrm(1,"app-loading",13),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("showLoading",e.loading)}}let w=(()=>{class o{constructor(e,i,n){this.productsService=e,this.dialogService=i,this.messageService=n,this.loading=!0,this.ref=new l.Pw,this.ProductColumnNames=R.q,this.productColumns=R.E,this.getPriceTypeCellData=C.K}ngOnInit(){this.updateData()}createProduct(){this.ref=this.dialogService.open(F,{header:"New product",width:"50rem",maximizable:!0}),this.onCloseSubscribe()}onRowSelect(e){this.ref=this.dialogService.open(F,{header:"Edit: "+e.data.name,data:e.data,width:"50rem",maximizable:!0}),this.onCloseSubscribe()}onCloseSubscribe(){this.ref.onClose.subscribe(e=>{e&&(this.messageService.add(e),this.updateData())})}updateData(){this.loading=!0,this.productsService.getProducts().subscribe({next:e=>{this.loading=!1,this.products=e},error:e=>this.messageService.add((0,a.T)(a.P.ERROR,e.message))})}static#t=this.\u0275fac=function(i){return new(i||o)(t.rXU(_),t.rXU(l.o3),t.rXU(d.bg))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-products"]],features:[t.Jv_([l.o3,d.bg])],decls:3,vars:2,consts:[["class","grid",4,"ngIf"],["class","flex justify-content-center",4,"ngIf"],[1,"grid"],[1,"col-12"],["pButton","","pRipple","","label","Add","icon","pi pi-plus",1,"mb-3",3,"click"],["class","card",4,"ngIf"],[1,"card"],["selectionMode","single","p-datatable-striped","",3,"onRowSelect","columns","value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[4,"ngFor","ngForOf"],[3,"pSelectableRow"],[1,"flex","justify-content-center"],[3,"showLoading"]],template:function(i,n){1&i&&(t.DNE(0,Y,4,1,"div",0),t.nrm(1,"p-toast"),t.DNE(2,O,2,1,"div",1)),2&i&&(t.Y8G("ngIf",!n.loading),t.R7$(2),t.Y8G("ngIf",n.loading))},dependencies:[p.Sq,p.bT,m._f,d.Ei,h.XI,h.d5,g.y8,T.q]})}return o})(),H=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.$C({type:o});static#o=this.\u0275inj=t.G2t({imports:[v.iI.forChild([{path:"",component:w}]),v.iI]})}return o})();var z=r(6296),J=r(9266),K=r(1579),W=r(1305),Z=r(5430),Q=r(1631),q=r(5193);let tt=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.$C({type:o});static#o=this.\u0275inj=t.G2t({imports:[p.MD,H,m.tm,b.u,h.bG,z.iV,P.kr,J.SW,K.d,u.YN,j.sv,x.O3,W.f,Z.q4,Q.H_,g.MB,G.F,q.H]})}return o})()}}]);